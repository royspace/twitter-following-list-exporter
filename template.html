<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Twitter Following List</title>
		<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
		<link
			rel="stylesheet"
			type="text/css"
			href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css"
		/>
		<!-- DataTables Extensions CSS -->
		<link
			rel="stylesheet"
			href="https://cdn.datatables.net/fixedheader/3.2.2/css/fixedHeader.dataTables.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.datatables.net/colreorder/1.5.5/css/colReorder.dataTables.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.datatables.net/select/1.3.4/css/select.dataTables.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.datatables.net/searchpanes/2.0.4/css/searchPanes.dataTables.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.datatables.net/searchbuilder/1.3.4/css/searchBuilder.dataTables.min.css"
		/>
		<link rel="stylesheet" href="css/style.css" />
		<script
			type="text/javascript"
			charset="utf8"
			src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"
		></script>
		<!-- DataTables Extensions JS -->
		<script src="https://cdn.datatables.net/fixedheader/3.2.2/js/dataTables.fixedHeader.min.js"></script>
		<script src="https://cdn.datatables.net/colreorder/1.5.5/js/dataTables.colReorder.min.js"></script>
		<script src="https://cdn.datatables.net/select/1.3.4/js/dataTables.select.min.js"></script>
		<script src="https://cdn.datatables.net/searchpanes/2.0.4/js/dataTables.searchPanes.min.js"></script>
		<script src="https://cdn.datatables.net/searchbuilder/1.3.4/js/dataTables.searchBuilder.min.js"></script>
		<script type="text/javascript" src="js/script.js"></script>
	</head>

	<body>
		<div class="page-header">
			<h1>Twitter Following List</h1>
			<button
				id="darkModeToggle"
				type="button"
				aria-pressed="false"
				title="Toggle dark mode"
			>
				üåô
			</button>
		</div>
		<table class="table" id="main_table">
			<thead>
				<tr>
					<th>PFP</th>
					<th>Name</th>
					<th>Nick</th>
					<th>Description</th>
					<th>Profile Banner</th>
					<th>ID</th>
					<th>Followers Count</th>
					<th>Friends Count</th>
					<th>Listed Count</th>
					<th>Statuses Count</th>
					<th>Media Count</th>
					<th>Favourites Count</th>
					<th>Date</th>
					<th>Location</th>
					<th>URL</th>
					<th>Verified</th>
				</tr>
			</thead>
			<tbody>
				{% for row in data %}
				<tr>
					<td class="profile_image">
						<img
							src="{{ row['profile_image'] if row['profile_image'] else 'images/' ~ row['id'] ~ '.jpg' }}"
							data-local-src="images/{{ row['id'] }}.jpg"
							data-default-src="images/0.png"
							data-fallback-step="0"
							alt="Profile Image"
							onerror="(function(img){var step=img.dataset.fallbackStep||'0'; if(step==='0'){img.dataset.fallbackStep='1'; img.src=img.dataset.localSrc;} else if(step==='1'){img.dataset.fallbackStep='2'; img.onerror=null; img.src=img.dataset.defaultSrc;} })(this);"
							loading="lazy"
							decoding="async"
						/>
					</td>
					<td class="name">
						<a
							href="{{ row['Permanent_Profile_Link'] }}"
							target="_blank"
							>{{ row['name'] }}</a
						>
					</td>
					<td class="nick">{{ row['nick'] }}</td>
					<td class="description">{{ row['description'] }}</td>
					<td class="profile_banner">
						<img
							src="{{ row['profile_banner'] if row['profile_banner'] else 'images/nobanner.png' }}"
							alt="Profile Banner"
							onerror="this.onerror=null;this.src='images/nobanner.png';"
							loading="lazy"
							decoding="async"
						/>
					</td>
					<td class="id">{{ row['id'] }}</td>
					<td class="followers_count">
						{{ row['followers_count'] }}
					</td>
					<td class="friends_count">{{ row['friends_count'] }}</td>
					<td class="listed_count">{{ row['listed_count'] }}</td>
					<td class="statuses_count">{{ row['statuses_count'] }}</td>
					<td class="media_count">{{ row['media_count'] }}</td>
					<td class="favourites_count">
						{{ row['favourites_count'] }}
					</td>
					<td class="date">{{ row['date'] }}</td>
					<td class="location">{{ row['location'] }}</td>
					<td class="url">{{ row['url'] }}</td>
					<td class="verified">{{ row['verified'] }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
		<script>
			(function () {
				var key = "themeMode";
				var saved = localStorage.getItem(key) || "light";
				var btn = document.getElementById("darkModeToggle");

				function apply(dark) {
					document.body.classList.toggle("dark", dark);
					if (btn) {
						btn.setAttribute(
							"aria-pressed",
							dark ? "true" : "false"
						);
						btn.textContent = dark ? "‚òÄÔ∏è" : "üåô";
					}
				}

				apply(saved === "dark");

				if (btn) {
					btn.addEventListener("click", function () {
						var dark = !document.body.classList.contains("dark");
						apply(dark);
						localStorage.setItem(key, dark ? "dark" : "light");
					});
				}
			})();
		</script>
	</body>
</html>
